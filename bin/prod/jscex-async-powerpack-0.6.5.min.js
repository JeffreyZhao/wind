(function(){var h,g,k,j,p=function(b){if(b.length<=1)return null;for(var a=[],d=1;d<b.length;d++)a.push(b[d]);return a},q=function(b,a){for(var d=[],c=0;c<b.length;c++)d.push(b[c]);for(;d.length<a;)d.push(void 0);return d},m=function(b){this.children=[];if(b)for(var a=0;a<b.length;a++)this.children.push(b[a])};m.prototype={_typeId:"4a73efb8-c2e2-4305-a05c-72385288650a",message:"This is an error contains sub-errors, please check the 'children' collection for more details.",isTypeOf:function(b){return b._typeId==
"4a73efb8-c2e2-4305-a05c-72385288650a"}};var t=function(b,a){return g.create(function(d){a&&a.isCancellationRequested&&d.complete("failure",new k);var c,f;a&&(f=function(){clearTimeout(c);d.complete("failure",new k)});c=setTimeout(function(){a&&a.unregister(f);d.complete("success")},b);a&&a.register(f)})},u=function(b,a,d){return g.create(function(c){d&&d.isCancellationRequested&&c.complete("failure",new k);var f=function(){b.removeEventListener?b.removeEventListener(a,e):b.removeListener?b.removeListener(a,
e):b.detachEvent(a,e)},e,i;d&&(i=function(){f();c.complete("failure",new k)});e=function(b){d&&d.unregister(i);f();c.complete("success",b)};b.addEventListener?b.addEventListener(a,e):b.addListener?b.addListener(a,e):b.attachEvent(a,e);d&&d.register(i)})},s=function(){var b;if(arguments.length==1){var a=arguments[0];b=g.isTask(a)?[a]:a}else{b=Array(arguments.length);for(a=0;a<arguments.length;a++)b[a]=arguments[a]}return g.create(function(a){var c={};j.each(b,function(a,e){e&&(g.isTask(e)||(b[a]=e=
s(e)),c[e.id]=a)});j.each(c,function(a,e){var c=b[e];c.status==="ready"&&c.start()});var f=function(){var e=j.isArray(b)?Array(b.length):{},f=[];j.each(c,function(a,c){var d=b[c];d.error?f.push(d.error):e[c]=d.result});f.length>0?a.complete("failure",new m(f)):a.complete("success",e)},e=0;j.each(c,function(a,c){var d=b[c];d.status=="running"&&(e++,d.addEventListener("complete",function(){--e==0&&f()}))});e==0&&f()})},v=function(){var b={};if(arguments.length==1){var a=arguments[0];g.isTask(a)?b[0]=
a:b=a}else for(a=0;a<arguments.length;a++)b[a]=arguments[a];return g.create(function(a){var c={},f;for(f in b)if(b.hasOwnProperty(f)){var e=b[f];g.isTask(e)&&(c[e.id]=f)}for(var i in c)e=b[c[i]],e.status=="ready"&&e.start();for(i in c)if(f=c[i],e=b[f],e.error||e.status=="succeeded"){a.complete("success",{key:f,task:e});return}var r=function(){for(var e in c)b[c[e]].removeEventListener("complete",r);a.complete("success",{key:c[this.id],task:this})};for(i in c)b[c[i]].addEventListener("complete",r)})},
w=function(b){var a=this;return g.create(function(d){var c=function(){this.error?d.complete("failure",this.error):d.complete("success",this.result)},f=function(){if(this.error)return d.complete("failure",this.error);var a;try{a=b(this.result)}catch(f){return d.complete("failure",f)}a.status=="ready"&&a.start();a.status=="running"?a.addEventListener("complete",c):c.call(a)};a.status=="ready"&&a.start();a.status=="running"?a.addEventListener("complete",f):f.call(a)})},x=function(b){var a=p(arguments);
return function(){var d=this,c=q(arguments,b.length-1);return g.create(function(f){c.push(function(b,c){if(b)f.complete("failure",b);else if(a){for(var d={},g=0;g<a.length;g++)d[a[g]]=arguments[g+1];return f.complete("success",d)}else f.complete("success",c)});b.apply(d,c)})}},y=function(b){var a=p(arguments);return function(){var d=this,c=q(arguments,b.length-1);return g.create(function(f){c.push(function(b){if(a){for(var c={},d=0;d<a.length;d++)c[a[d]]=arguments[d];f.complete("success",c)}else f.complete("success",
b)});b.apply(d,c)})}},n=!!(typeof require==="function"&&typeof module!=="undefined"&&module.exports),l=!!(typeof require==="function"&&typeof define==="function"&&define.amd),o=function(){h.define({name:"async-powerpack",version:"0.6.5",exports:n&&module.exports,require:n&&require,dependencies:{async:"~0.6.5"},init:function(){j=h._;g=h.Async.Task;k=h.Async.CanceledError;var b=h.Async;b.sleep=t;b.onEvent=u;b.AggregateError=m;g.whenAll=s;g.whenAny=v;g.prototype.then=g.prototype.continueWith=w;if(!b.Binding)b.Binding=
{};var a=b.Binding;b.Jscexify=a;a.fromStandard=x;a.fromCallback=y}})};if(n){try{h=require("./jscex")}catch(z){h=require("jscex")}o()}else if(l)require(["jscex"],function(b){h=b;o()});else{l=Function("return this")();if(!l.Jscex)throw Error('Missing the root object, please load "jscex" component first.');h=l.Jscex;o()}})();
